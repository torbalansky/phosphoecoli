{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="card border-0 mt-2">
  <div class="row justify-content-center">
    <h2 class="card-title text-center m-5"><em>Phoshorylation E.coli Data Base (pEDB)</em></h2>
  <div class="col-lg-5">
    <form class="form-inline" method="get" action="{% url 'protein_list' %}">
      <h6 class="text-center">Quick Search</h6>
        <div class="input-group">
            <select class="custom-select" id="search_category" name="search_category">
                <option value="uniprot">Uniprot ID</option>
                <option value="gene">Gene Name</option>
                <option value="protein">Protein Name</option>
            </select>
            <input class="form-control form-control-navbar" type="search" placeholder="Search" aria-label="Search" name="q">
                <button class="btn btn-primary" type="submit">Search</button>
        </div>
    </form>
  </div>
</div>
  <div class="row no-gutters mt-2">
    <div class="col-md-2">
      <div class="home-protein-view" id="protein-viewer"></div>
    </div>
    <div class="col-md-10 p-5">
      <div class="card-body">
        <p class="card-text">
          <em>pEDB</em> serves as an exhaustive repository for protein phosphorylation data within 
          <em>E.coli</em>, comprising a considerable collection of phospho-proteins totaling ***** and 
          identifying **** phospho-sites. Acknowledged as a cornerstone in prokaryotic systems, 
          protein phosphorylation represents an estimated ***% of the total phosphorylated amino 
          acids in <em>E.coli</em>, emphasizing its critical role across diverse cellular processes. 
          Boasting a rich array of annotated phospho-sites, this online database stands as an 
          indispensable resource for researchers delving into protein phosphorylation within the 
          microbial realm. Furthermore, access to the platform is unrestricted and freely available 
          to all users, including commercial entities.
        </p>
      </div>
    </div>
  </div>
</div>

<script src="https://unpkg.com/ngl@latest/dist/ngl.js"></script>
<link href="https://unpkg.com/ngl@latest/dist/css/ngl.css" rel="stylesheet">

<script>
  var stage = new NGL.Stage("protein-viewer");
  var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);

  window.addEventListener("resize", function(event) {
      stage.handleResize();
  }, false);

  if (isChrome) {
    stage.loadFile("rcsb://4icd", { defaultRepresentation: true });
    stage.setParameters({ backgroundColor: "white" });
    stage.setSpin(true);
  } else {
    var proteinViewer = document.getElementById("protein-viewer");
    proteinViewer.innerHTML = "<img src='{% static 'images/logo_PS_s.png' %}' alt='Protein Image'>";
    proteinViewer.querySelector("img").style.width = "150px"; 
    proteinViewer.querySelector("img").style.height = "auto"; 
    proteinViewer.querySelector("img").style.marginTop = "100px"; 
    proteinViewer.querySelector("img").style.marginLeft = "15px";
  }

  const searchCategoryDropdown = document.getElementById('search_category');
  const searchQueryInput = document.querySelector('.form-control-navbar');

    function setPlaceholder() {
        const selectedOption = searchCategoryDropdown.value;
  
        switch (selectedOption) {
            case 'uniprot':
                searchQueryInput.placeholder = 'P08200';
                break;
            case 'gene':
                searchQueryInput.placeholder = 'icd';
                break;
            case 'protein':
                searchQueryInput.placeholder = 'Isocitrate dehydrogenase';
                break;
            default:
                searchQueryInput.placeholder = 'P08200';
        }
    }

  window.addEventListener('load', setPlaceholder);
  searchCategoryDropdown.addEventListener('change', setPlaceholder);

</script>

{% endblock %}